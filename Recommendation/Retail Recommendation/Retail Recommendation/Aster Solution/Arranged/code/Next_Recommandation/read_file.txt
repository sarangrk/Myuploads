##################################################################
2. Create table for data

create schema madura;

drop table if exists madura.pos;
CREATE TABLE madura.pos  ( 
	Store_ID integer ,
	Cust_Mob_No varchar, 
	Txn_Date  date,
	Txn_Id   integer,
	SubBrand varchar,
	pattern1 varchar,
	fit varchar,
	fashion_pyramid varchar,
	Loyalty_Customer varchar,
	Style_Code varchar,
	Category varchar,
	Sleeve varchar,
	Size varchar
	)
	DISTRIBUTE BY HASH (Txn_Id)
;

--ncluster_loader -D ',' -U db_superuser -w db_superuser --el-discard-errors --el-enabled --skip-rows 1 --date-style SQL,DMY madura.pos /home/aster/POS.csv

select * from madura.pos;


drop table if exists madura.pos1;

CREATE TABLE madura.pos1  DISTRIBUTE BY HASH (Txn_Id)
as select *
    , Style_Code || '_'  || SubBrand || '_'  || category || '_'  || sleeve || '_'  || fit || '_'  || pattern1 || '_' || Size || '_'  ||
       fashion_pyramid as product
    from madura.pos
    
 --   Comments - clean
 --   , Comment_verbitum - bad
    
select * from madura.pos1 ;

   


